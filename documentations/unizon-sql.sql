/*
CSERE:
EZT: VARCHAR2 (100)
ERRE: VARCHAR(100)


(igen ott extra szokoz van a number elott)
EZT:  NUMBER
ERRE:  INT



TOROLNI:
NOT DEREFERRABLE
*/


-- Generated by Oracle SQL Developer Data Modeler 4.1.3.901
--   at:        2016-03-21 20:08:13 CET
--   site:      Oracle Database 12c
--   type:      Oracle Database 12c

create database unizon character set utf8;

use unizon;

-- Generated by Oracle SQL Developer Data Modeler 4.1.3.901
--   at:        2016-03-21 20:26:21 CET
--   site:      Oracle Database 12c
--   type:      Oracle Database 12c


CREATE TABLE ADDRESS
  (
    ADDRESS_ID INT NOT NULL ,
    ZIP        VARCHAR(20) ,
    COUNTRY    VARCHAR(100) ,
    CITY       VARCHAR(100) ,
    STREET     VARCHAR(100) ,
    STR_NUMBER INT ,
    FLOOR      INT ,
    DOOR       INT
  ) ;
ALTER TABLE ADDRESS ADD CONSTRAINT ADDRESS_PK PRIMARY KEY ( ADDRESS_ID ) ;


CREATE TABLE ADDRESSES_OF_USER
  (
    DESCRIPTION VARCHAR(100) ,
    USER_ID     INT NOT NULL ,
    ADDRESS_ID  INT NOT NULL
  ) ;
ALTER TABLE ADDRESSES_OF_USER ADD CONSTRAINT ADDRESSES_OF_USER_PK PRIMARY KEY ( USER_ID, ADDRESS_ID ) ;


CREATE TABLE CATEGORY
  ( CATEGORY_ID INT NOT NULL , NAME VARCHAR(100)
  ) ;
ALTER TABLE CATEGORY ADD CONSTRAINT CATEGORY_PK PRIMARY KEY ( CATEGORY_ID ) ;
ALTER TABLE CATEGORY ADD CONSTRAINT CATEGORY_UNIQUE UNIQUE ( NAME ) ;


CREATE TABLE CAT_TO_PROD
  (
    PRODUCT_ID  INT NOT NULL ,
    CATEGORY_ID INT NOT NULL
  ) ;
ALTER TABLE CAT_TO_PROD ADD CONSTRAINT CAT_TO_PROD_PK PRIMARY KEY ( PRODUCT_ID, CATEGORY_ID ) ;


CREATE TABLE CAT_TO_TAG
  (
    CATEGORY_ID INT NOT NULL ,
    TAG_ID      INT NOT NULL
  ) ;
ALTER TABLE CAT_TO_TAG ADD CONSTRAINT CAT_TO_TAG_PK PRIMARY KEY ( CATEGORY_ID, TAG_ID ) ;


CREATE TABLE PHONE_NUMBER
  (
    PHONE_NUMBER_ID INT NOT NULL ,
    PHONE_NUMBER    VARCHAR(100)
  ) ;
ALTER TABLE PHONE_NUMBER ADD CONSTRAINT PHONE_NUMBER_PK PRIMARY KEY ( PHONE_NUMBER_ID ) ;
ALTER TABLE PHONE_NUMBER ADD CONSTRAINT PHONE_NUMBER__UNIQUE UNIQUE ( PHONE_NUMBER ) ;


CREATE TABLE PRODUCT
  (
    PRODUCT_ID  INT NOT NULL ,
    TITLE       VARCHAR(100) ,
    PRICE       INT ,
    AMOUNT      INT ,
    DESCRIPTION VARCHAR(100)
  ) ;
ALTER TABLE PRODUCT ADD CONSTRAINT PRODUCT_PK PRIMARY KEY ( PRODUCT_ID ) ;


CREATE TABLE PROD_TO_ORDER
  (
    ORDER_ID   INT NOT NULL ,
    PRODUCT_ID INT NOT NULL ,
    AMOUNT     INT
  ) ;
ALTER TABLE PROD_TO_ORDER ADD CONSTRAINT PROD_TO_ORDER_PK PRIMARY KEY ( ORDER_ID, PRODUCT_ID ) ;


CREATE TABLE PROD_TO_TAG
  (
    PRODUCT_ID INT NOT NULL ,
    TAG_ID     INT NOT NULL
  ) ;
ALTER TABLE PROD_TO_TAG ADD CONSTRAINT PROD_TO_TAG_PK PRIMARY KEY ( PRODUCT_ID, TAG_ID ) ;


CREATE TABLE TAG
  ( TAG_ID INT NOT NULL , NAME VARCHAR(100)
  ) ;
ALTER TABLE TAG ADD CONSTRAINT TAG_PK PRIMARY KEY ( TAG_ID ) ;
ALTER TABLE TAG ADD CONSTRAINT TAG_UNIQUE UNIQUE ( NAME ) ;


CREATE TABLE UNI_ORDER
  (
    ORDER_ID            INT NOT NULL ,
    USER_ID             INT NOT NULL ,
    PHONE_NUMBER_ID     INT NOT NULL ,
    ORDER_DATE          DATE ,
    SHIPPING_ADDRESS_ID INT NOT NULL ,
    BILLING_ADDRESS_ID  INT NOT NULL
  ) ;
ALTER TABLE UNI_ORDER ADD CONSTRAINT ORDER_PK PRIMARY KEY ( ORDER_ID ) ;


CREATE TABLE UNI_USER
  (
    USER_ID            INT NOT NULL ,
    USERNAME           VARCHAR(100) ,
    E_MAIL             VARCHAR(100) ,
    PHONE_NUMBER_ID    INT NOT NULL ,
    ENCRYPTED_PASSWORD VARCHAR(100) ,
    NAME               VARCHAR(100) ,
    REGISTRATION_DATE  DATE ,
    DEFAULT_ADDRESS_ID INT NOT NULL
  ) ;
ALTER TABLE UNI_USER ADD CONSTRAINT USER_PK PRIMARY KEY ( USER_ID ) ;
ALTER TABLE UNI_USER ADD CONSTRAINT USER_USERNAME_UNIQUE UNIQUE ( USERNAME ) ;
ALTER TABLE UNI_USER ADD CONSTRAINT USER__EMAIL_UNIQUE UNIQUE ( E_MAIL ) ;


ALTER TABLE ADDRESSES_OF_USER ADD CONSTRAINT ADDRESSES_OF_USER_ADDRESS_FK FOREIGN KEY ( ADDRESS_ID ) REFERENCES ADDRESS ( ADDRESS_ID ) ;

ALTER TABLE ADDRESSES_OF_USER ADD CONSTRAINT ADDRESSES_OF_USER_USER_FK FOREIGN KEY ( USER_ID ) REFERENCES UNI_USER ( USER_ID ) ;

ALTER TABLE CAT_TO_PROD ADD CONSTRAINT CAT_TO_PROD_CATEGORY_FK FOREIGN KEY ( CATEGORY_ID ) REFERENCES CATEGORY ( CATEGORY_ID ) ;

ALTER TABLE CAT_TO_PROD ADD CONSTRAINT CAT_TO_PROD_PRODUCT_FK FOREIGN KEY ( PRODUCT_ID ) REFERENCES PRODUCT ( PRODUCT_ID ) ;

ALTER TABLE CAT_TO_TAG ADD CONSTRAINT CAT_TO_TAG_CATEGORY_FK FOREIGN KEY ( CATEGORY_ID ) REFERENCES CATEGORY ( CATEGORY_ID ) ;

ALTER TABLE CAT_TO_TAG ADD CONSTRAINT CAT_TO_TAG_TAG_FK FOREIGN KEY ( TAG_ID ) REFERENCES TAG ( TAG_ID ) ;

ALTER TABLE UNI_ORDER ADD CONSTRAINT ORDER_ADDRESS_FK FOREIGN KEY ( SHIPPING_ADDRESS_ID ) REFERENCES ADDRESS ( ADDRESS_ID ) ;

ALTER TABLE UNI_ORDER ADD CONSTRAINT ORDER_ADDRESS_FKv1 FOREIGN KEY ( BILLING_ADDRESS_ID ) REFERENCES ADDRESS ( ADDRESS_ID ) ;

ALTER TABLE UNI_ORDER ADD CONSTRAINT ORDER_PHONE_NUMBER_FK FOREIGN KEY ( PHONE_NUMBER_ID ) REFERENCES PHONE_NUMBER ( PHONE_NUMBER_ID ) ;

ALTER TABLE UNI_ORDER ADD CONSTRAINT ORDER_USER_FK FOREIGN KEY ( USER_ID ) REFERENCES UNI_USER ( USER_ID ) ;

ALTER TABLE PROD_TO_ORDER ADD CONSTRAINT PROD_TO_ORDER_ORDER_FK FOREIGN KEY ( ORDER_ID ) REFERENCES UNI_ORDER ( ORDER_ID ) ;

ALTER TABLE PROD_TO_ORDER ADD CONSTRAINT PROD_TO_ORDER_PRODUCT_FK FOREIGN KEY ( PRODUCT_ID ) REFERENCES PRODUCT ( PRODUCT_ID ) ;

ALTER TABLE PROD_TO_TAG ADD CONSTRAINT PROD_TO_TAG_PRODUCT_FK FOREIGN KEY ( PRODUCT_ID ) REFERENCES PRODUCT ( PRODUCT_ID ) ;

ALTER TABLE PROD_TO_TAG ADD CONSTRAINT PROD_TO_TAG_TAG_FK FOREIGN KEY ( TAG_ID ) REFERENCES TAG ( TAG_ID ) ;

ALTER TABLE UNI_USER ADD CONSTRAINT USER_ADDRESS_FK FOREIGN KEY ( DEFAULT_ADDRESS_ID ) REFERENCES ADDRESS ( ADDRESS_ID ) ;

ALTER TABLE UNI_USER ADD CONSTRAINT USER_PHONE_NUMBER_FK FOREIGN KEY ( PHONE_NUMBER_ID ) REFERENCES PHONE_NUMBER ( PHONE_NUMBER_ID ) ;


-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            12
-- CREATE INDEX                             0
-- ALTER TABLE                             33
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- TSDP POLICY                              0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
